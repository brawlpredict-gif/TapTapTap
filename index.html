<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>IljaClicker</title>

<style>

html, body {
    margin: 0;
    padding: 0;
    background-color: #111;
    color: white;
    font-family: Arial;
    height: 100%;
    overflow: hidden;

    touch-action: manipulation;
}

body {
    display: flex;
}

/* игра */
#gameArea {
    flex: 3;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

/* магазин */
#shop {
    flex: 1;
    background-color: #222;
    padding: 20px;
}

#score {
    font-size: 48px;
    margin-bottom: 20px;
}

#imageContainer {
    position: relative;
}

/* фото */
#image {
    width: 600px;
    display: block;

    user-select: none;
    -webkit-user-select: none;
    -webkit-user-drag: none;

    touch-action: manipulation;
}

/* ripple */
.ripple {
    position: absolute;
    border-radius: 50%;
    border: 3px solid cyan;
    width: 100px;
    height: 100px;
    transform: scale(0);
    animation: ripple 0.5s linear;
}

@keyframes ripple {
    to {
        transform: scale(4);
        opacity: 0;
    }
}

/* текст */
.plus {
    position: absolute;
    color: lime;
    font-size: 30px;
    animation: float 0.8s forwards;
}

@keyframes float {
    to {
        transform: translateY(-80px);
        opacity: 0;
    }
}

/* рыбий глаз */
.lens {
    position: absolute;
    width: 180px;
    height: 180px;
    border-radius: 50%;
    overflow: hidden;
    animation: lensAnim 0.3s forwards;
}

.lens img {
    position: absolute;
    width: 600px;
    transform: scale(1.4);
}

@keyframes lensAnim {
    to {
        transform: scale(1.2);
        opacity: 0;
    }
}

/* кнопки */
.upgrade {
    width: 100%;
    padding: 15px;
    margin-bottom: 10px;
    font-size: 20px;
}

.upgrade:disabled {
    opacity: 0.5;
}

</style>
</head>

<body>

<div id="gameArea">

<div id="score">0</div>

<div id="imageContainer">
<img src="brother.png" id="image">
</div>

</div>

<div id="shop">

<h2>Апгрейды</h2>

<button id="upgrade2" class="upgrade">
Двойной клик (100)
</button>

<button id="upgrade3" class="upgrade">
Тройной клик (300)
</button>

</div>

<script>

let score = 0;
let clickValue = 1;

let bought2 = false;
let bought3 = false;

let image = document.getElementById("image");
let container = document.getElementById("imageContainer");

let scoreText = document.getElementById("score");

let upgrade2 = document.getElementById("upgrade2");
let upgrade3 = document.getElementById("upgrade3");

/* звук */
function sound()
{
    let a = new Audio("click.mp3");
    a.volume = 0.2;
    a.play();
}

/* обновление кнопок */
function updateButtons()
{
    if(!bought2)
        upgrade2.disabled = score < 100;
    else
        upgrade2.disabled = true;

    if(!bought3)
        upgrade3.disabled = score < 300;
    else
        upgrade3.disabled = true;
}

/* клик */
image.addEventListener("pointerdown", function(e)
{
    e.preventDefault();

    score += clickValue;

    scoreText.innerText = score;

    sound();

    let rect = container.getBoundingClientRect();

    let x = e.clientX - rect.left;
    let y = e.clientY - rect.top;

    /* ripple */
    let r = document.createElement("div");
    r.className = "ripple";
    r.style.left = (x-50)+"px";
    r.style.top = (y-50)+"px";

    container.appendChild(r);

    setTimeout(()=>r.remove(),500);

    /* текст */
    let p = document.createElement("div");
    p.className = "plus";
    p.innerText = "+"+clickValue;

    p.style.left = x+"px";
    p.style.top = y+"px";

    container.appendChild(p);

    setTimeout(()=>p.remove(),800);

    /* линза */
    let lens = document.createElement("div");
    lens.className = "lens";

    lens.style.left = (x-90)+"px";
    lens.style.top = (y-90)+"px";

    let img = document.createElement("img");

    img.src = image.src;

    img.style.left = -(x-90)*1.4+"px";
    img.style.top = -(y-90)*1.4+"px";

    lens.appendChild(img);

    container.appendChild(lens);

    setTimeout(()=>lens.remove(),300);

    updateButtons();
});

/* двойной */
upgrade2.onclick = function()
{
    if(score>=100 && !bought2)
    {
        score-=100;
        clickValue=2;
        bought2=true;

        scoreText.innerText=score;

        upgrade2.innerText="Куплено";
        upgrade2.disabled=true;
    }
}

/* тройной */
upgrade3.onclick=function()
{
    if(score>=300 && !bought3)
    {
        score-=300;
        clickValue=3;
        bought3=true;

        scoreText.innerText=score;

        upgrade3.innerText="Куплено";
        upgrade3.disabled=true;
    }
}

updateButtons();

</script>

</body>
</html>
